# Makefile for mpz/tests for GNU MP

srcdir = .

CC = gcc

TEST_LIBS = ../../libgmp.a
INCLUDES = -I../../mpn -I$(srcdir)/../..
CFLAGS = -g -O

.c.o:
	$(CC) -c $(INCLUDES) $(CFLAGS) $(XCFLAGS) $<

TEST_SRCS = t-mul.c t-tdiv.c t-tdiv_ui.c t-fdiv.c t-fdiv_ui.c t-gcd.c \
  dive.c t-sqrtrem.c convert.c io.c logic.c bit.c t-powm.c t-powm_ui.c \
  t-pow_ui.c t-2exp.c reuse.c
TEST_OBJS = t-mul.o t-tdiv.o t-tdiv_ui.o t-fdiv.o t-fdiv_ui.o t-gcd.o \
 dive.o t-sqrtrem.o convert.o io.o logic.o bit.o t-powm.o t-powm_ui.o \
 t-pow_ui.o t-2exp.o reuse.o
TESTS = t-mul t-tdiv t-tdiv_ui t-fdiv t-fdiv_ui t-gcd \
 dive t-sqrtrem convert io logic bit t-powm t-powm_ui t-pow_ui t-2exp reuse

check: Makefile st-mul st-tdiv st-tdiv_ui st-fdiv st-fdiv_ui st-gcd st-dive \
  st-sqrtrem st-convert st-io st-logic st-bit st-powm st-powm_ui st-pow_ui \
  st-2exp st-reuse
	@echo "The tests passed."

st-mul: t-mul
	./t-mul
	touch $@
st-tdiv: t-tdiv
	./t-tdiv
	touch $@
st-tdiv_ui: t-tdiv_ui
	./t-tdiv_ui
	touch $@
st-fdiv: t-fdiv
	./t-fdiv
	touch $@
st-fdiv_ui: t-fdiv_ui
	./t-fdiv_ui
	touch $@
st-gcd: t-gcd
	./t-gcd
	touch $@
st-dive: dive
	./dive
	touch $@
st-sqrtrem: t-sqrtrem
	./t-sqrtrem
	touch $@
st-convert: convert
	./convert
	touch $@
st-io: io
	./io
	touch $@
st-logic: logic
	./logic
	touch $@
st-bit: bit
	./bit
	touch $@
st-powm: t-powm
	./t-powm
	touch $@
st-powm_ui: t-powm_ui
	./t-powm_ui
	touch $@
st-pow_ui: t-pow_ui
	./t-pow_ui
	touch $@
st-2exp: t-2exp
	./t-2exp
	touch $@
st-reuse: reuse
	./reuse
	touch $@

t-mul: t-mul.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
t-tdiv: t-tdiv.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
t-tdiv_ui: t-tdiv_ui.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
t-fdiv: t-fdiv.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
t-fdiv_ui: t-fdiv_ui.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
t-gcd: t-gcd.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
dive: dive.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
t-sqrtrem: t-sqrtrem.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
convert: convert.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
io: io.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
logic: logic.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
bit: bit.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
t-powm: t-powm.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
t-powm_ui: t-powm_ui.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
t-pow_ui: t-pow_ui.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
t-2exp: t-2exp.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)
reuse: reuse.o $(TEST_LIBS)
	$(CC) -o $@ $@.o $(TEST_LIBS) $(CFLAGS) $(XCFLAGS)

t-mul.o: $(srcdir)/t-mul.c
t-tdiv.o: $(srcdir)/t-tdiv.c
t-tdiv_ui.o: $(srcdir)/t-tdiv_ui.c
t-fdiv.o: $(srcdir)/t-fdiv.c
t-fdiv_ui.o: $(srcdir)/t-fdiv_ui.c
t-gcd.o: $(srcdir)/t-gcd.c
dive.o: $(srcdir)/dive.c
t-sqrtrem.o: $(srcdir)/t-sqrtrem.c
convert.o: $(srcdir)/convert.c
io.o: $(srcdir)/io.c
logic.o: $(srcdir)/logic.c
bit.o: $(srcdir)/bit.c
t-powm.o: $(srcdir)/t-powm.c
t-powm_ui.o: $(srcdir)/t-powm_ui.c
t-pow_ui.o: $(srcdir)/t-pow_ui.c
reuse.o: $(srcdir)/reuse.c
t-2exp.o: $(srcdir)/t-2exp.c

clean mostlyclean:
	rm -f *.o st-* $(TESTS)
distclean maintainer-clean: clean
	rm -f Makefile config.status

Makefile: $(srcdir)/Makefile.in
	$(SHELL) ./config.status
