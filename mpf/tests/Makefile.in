# Makefile for mpf/tests for GNU MP

srcdir = .

CC = gcc

TEST_LIBS = ../../libgmp.a
INCLUDES = -I../../mpn -I$(srcdir)/../..
CFLAGS = -g -O

.c.o:
	$(CC) -c $(INCLUDES) $(CFLAGS) $(XCFLAGS) $<

TEST_SRCS = t-add.c t-sub.c t-conv.c t-sqrt.c ref.c
TEST_OBJS = t-add.o t-sub.o t-conv.o t-sqrt.o
TESTS = t-add t-sub t-conv t-sqrt

check: st-add st-sub st-conv st-sqrt
	@echo "The tests passed."

st-add: t-add
	./t-add
	touch $@
st-sub: t-sub
	./t-sub
	touch $@
st-conv: t-conv
	./t-conv
	touch $@
st-sqrt: t-sqrt
	./t-sqrt
	touch $@

H = $(srcdir)/../../gmp.h $(srcdir)/../../gmp-impl.h \
 $(srcdir)/../../urandom.h ../../mpn/gmp-mparam.h

t-add: t-add.o ref.o $(TEST_LIBS)
	$(CC) -o $@ $@.o ref.o $(TEST_LIBS) $(CFLAGS)
t-sub: t-sub.o ref.o $(TEST_LIBS)
	$(CC) -o $@ $@.o ref.o $(TEST_LIBS) $(CFLAGS)
t-conv: t-conv.o ref.o $(TEST_LIBS)
	$(CC) -o $@ $@.o ref.o $(TEST_LIBS) $(CFLAGS)
t-sqrt: t-sqrt.o ref.o $(TEST_LIBS)
	$(CC) -o $@ $@.o ref.o $(TEST_LIBS) $(CFLAGS)

t-add.o: $(srcdir)/t-add.c
t-sub.o: $(srcdir)/t-sub.c
t-conv.o: $(srcdir)/t-conv.c
t-sqrt.o: $(srcdir)/t-sqrt.c
t-ref.o: $(srcdir)/t-ref.c

clean mostlyclean:
	rm -f *.o st-* $(TESTS)
distclean maintainer-clean: clean
	rm -f Makefile config.status

Makefile: $(srcdir)/Makefile.in
	$(SHELL) ./config.status
